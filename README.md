# Triangle Travel

A web app that finds a third city to fly through and explore on your round-trip itinerary. Built with **Go** (Gin), **Svelte**, and **SQLite**.

## Explanation

A round-trip flight can be represented as a graph with nodes A and B, and edges A→B and B→A. The goal is to find a city (node C) you can visit from either A or B—e.g. A→B, B→C, C→A. The app suggests:

- **Drive/train then fly**: Nearby airports (55–300 miles) you can reach by ground, then fly from
- **Fly then fly**: Direct flight routes from your destination to a third city, then back to origin

## Tech Stack

- **Backend**: Go, [Gin](https://github.com/gin-gonic/gin)
- **Frontend**: [Svelte](https://svelte.dev/) (SvelteKit + Vite)
- **Database**: SQLite (replaces `iata_cities.json`, `distances.json`, `city_routes.json`)

## Requirements

- Go 1.21+
- Node.js 18+

## Quick Start

### 1. Seed the database

```bash
go run ./cmd/seed
```

This creates `db/data.sqlite3` from the JSON files.

### 2. Install frontend dependencies

```bash
npm install
```

### 3. Build and run

```bash
npm run build          # Build Svelte app to build/
go run . # Start server at http://localhost:8080
```

Or use the Makefile:

```bash
make seed
make build
./triangle_travel
```

## Development

Run the frontend dev server (proxies `/api` to the backend):

```bash
npm run dev
```

In another terminal, run the Go server:

```bash
go run .
```

- Frontend: http://localhost:5173
- API: http://localhost:8080

## Project Structure

```
triangle_travel/
├── main.go                 # Entry point
├── cmd/
│   └── seed/               # DB seed from JSON
├── internal/
│   ├── api/                # Gin handlers
│   ├── db/                 # SQLite access
│   ├── flights/            # Triangle travel logic
│   ├── helpers/            # Utilities
│   └── server/             # HTTP server
├── db/
│   ├── schema.sql          # SQLite schema
│   └── data.sqlite3        # (generated by seed)
├── src/                    # Svelte frontend
│   ├── routes/
│   └── app.css
├── build/                  # (generated by npm run build)
├── iata_cities.json        # Source data
├── distances.json
├── city_routes.json
├── package.json
├── go.mod
└── Makefile
```

## API

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/search` | Search triangle options (start, end, startDate, endDate, alliance) |
| GET | `/api/cities` | List known city codes |

## Docker

```bash
docker build -t triangle-travel .
docker run -p 8080:8080 triangle-travel
```

The image seeds the database at build time and serves the app at http://localhost:8080.

## Deploy to Render.com

The app is a single Web Service (Go backend + Svelte SPA). Uses pure Go SQLite (no CGO) for easy deployment.

1. Push to GitHub and connect the repo in [Render](https://render.com).
2. Create a **Web Service**; Render will detect `render.yaml` if present.
3. Or configure manually:
   - **Runtime**: Docker
   - **Dockerfile Path**: `./Dockerfile`
   - **Instance**: Free tier works (SQLite is ephemeral; DB seeds at build time)

Render sets `PORT` automatically; the server reads it. Your app will be at `https://<your-service>.onrender.com`.


## To-Do

- [ ] Add test cases
- [ ] Add more cities to the database
- [ ] Prevent same-city searches (e.g. LGA to EWR)
- [ ] Add airline filter
- [ ] Integrate flight price API (optional)
